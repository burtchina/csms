# CSMS 系统实时设备监控使用指南

## 功能简介

CSMS 系统的实时监控模块允许用户对网络设备进行实时性能监控，包括 CPU 使用率、内存使用率、接口流量等关键指标。该模块支持华为、思科等多种网络设备，并提供友好的用户界面展示实时数据。

## 主要功能

- 实时监控设备 CPU 和内存使用率
- 监控网络接口状态和流量
- 自动记录性能数据并持久化存储
- 支持设置性能阈值和告警
- 实时图表展示性能变化趋势

## 使用方法

### 1. 访问实时监控页面

通过菜单导航到 "性能管理" -> "实时监控"，或直接访问以下链接：

```
http://服务器地址:端口/performance/realtime/设备ID
```

例如：`http://192.168.50.204:5000/performance/realtime/1`

### 2. 启动监控

在实时监控页面，点击 "启动监控" 按钮开始对设备进行实时监控。系统会自动连接到设备并开始采集数据。

### 3. 观察实时数据

启动监控后，页面上的仪表盘和图表会实时更新，显示设备的性能数据。您可以：

- 查看 CPU、内存、带宽等使用率
- 观察性能趋势图
- 检查接口状态和流量

### 4. 调整显示选项

- **数据点数量**：选择要在图表中显示的数据点数量
- **自动调整刻度**：启用/禁用图表 Y 轴的自动缩放
- **刷新间隔**：调整数据刷新频率

### 5. 停止监控

监控完成后，点击 "停止监控" 按钮结束监控，系统会自动断开与设备的连接。

## 支持的设备类型

系统目前支持以下设备类型：

- 华为设备（Huawei）
- 思科设备（Cisco）
- 其他通用网络设备（可能需要额外配置）

## 技术要求

### 设备要求

- 设备必须允许 SSH 远程登录
- 需要提供设备的 IP 地址、SSH 端口、用户名和密码
- 设备必须支持标准的 CLI 命令查询性能信息

### 系统要求

系统需要安装以下 Python 库才能完全支持所有监控功能：

```bash
pip install netmiko paramiko pyasn1 pysnmp flask-sqlalchemy
```

## 故障排除

### 常见问题

1. **无法连接到设备**
   - 检查设备 IP 地址、SSH 端口是否正确
   - 确认用户名密码是否正确
   - 检查设备是否允许 SSH 远程登录

2. **监控数据显示为零或异常**
   - 检查设备类型是否正确设置
   - 确认设备支持相关性能查询命令
   - 检查用户权限是否足够执行性能查询命令

3. **监控频繁断开**
   - 检查网络连接是否稳定
   - 增加保活间隔，减少断开可能
   - 检查设备 SSH 会话超时设置

## 配置参数说明

### 监控间隔配置

系统默认配置：
- CPU 和内存监控间隔：10 秒
- 接口监控间隔：30 秒
- 保活信号间隔：25 秒

这些参数可以根据需要在代码中调整，以平衡监控精度和系统性能。

### 数据保存

性能数据会自动保存到数据库中，可以用于后续的历史分析和报表生成。每次监控会自动创建 `PerformanceRecord` 记录。

## 高级用法

### 阈值监控

系统支持对性能数据设置阈值，超过阈值时可以触发告警。您可以通过 `ThresholdManager` 类配置阈值规则。

### 多设备同时监控

系统支持同时监控多台设备，每台设备会创建独立的监控线程，互不影响。


---

如需更多帮助，请联系系统管理员或查阅开发文档。 